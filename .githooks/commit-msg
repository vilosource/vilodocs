#!/bin/bash

# Git commit-msg hook to prevent AI attribution in commit messages
# This hook is called with one argument: the name of the file that contains the commit message

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# List of patterns that indicate AI attribution
AI_PATTERNS=(
    "Generated with.*Claude"
    "Co-Authored-By:.*Claude"
    "Co-Authored-By:.*Anthropic"
    "Generated by.*AI"
    "Generated by.*Claude"
    "Generated by.*GPT"
    "Created by.*AI"
    "Written by.*AI"
    "ü§ñ"
    "noreply@anthropic.com"
    "claude.ai"
)

# Check for AI attribution patterns
for pattern in "${AI_PATTERNS[@]}"; do
    if echo "$COMMIT_MSG" | grep -Ei "$pattern" > /dev/null; then
        echo "‚ùå Commit rejected: AI attribution detected in commit message"
        echo ""
        echo "Found pattern: '$pattern'"
        echo ""
        echo "Please remove any AI attribution from your commit message, including:"
        echo "  - References to Claude, GPT, or other AI tools"
        echo "  - 'Generated with' or 'Co-Authored-By' AI attributions"
        echo "  - Robot emojis (ü§ñ)"
        echo "  - AI service email addresses"
        echo ""
        echo "Your commit message:"
        echo "---"
        echo "$COMMIT_MSG"
        echo "---"
        exit 1
    fi
done

# If we get here, the commit message is clean
exit 0